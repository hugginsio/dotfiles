#!/bin/sh
# vi: ft=bash

# -e: exit on error
# -u: exit on unset variables
set -eu

{{ if eq .osid "linux-debian" -}}

echo "Detected: Debian-like Linux"
echo "Upgrading packages and installing essentials..."

sudo apt-get -yqq update && sudo apt-get -yqq upgrade
sudo apt-get -yqq install --no-install-recommends build-essential git curl fzf vim bat

mkdir -p ~/.local/bin
ln -sf /usr/bin/batcat ~/.local/bin/bat

{{ if eq .chezmoi.osRelease.id "ubuntu" -}}

echo "Detected: Ubuntu"
echo "Adding repository ppa:fish-shell and installing fish..."

sudo apt-add-repository -y ppa:fish-shell/release-3
sudo apt-get -yqq update && sudo apt-get -yqq upgrade
sudo apt-get -yqq install --no-install-recommends fish

{{ end -}}

echo "Cleaning up..."
sudo apt-get -yqq autoremove

{{ else -}}

echo "Detected: unsupported configuration \"{{ .osid -}}\""

{{ end -}}
